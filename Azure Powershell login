function LogIn
{ 
    try
    {
        $servicePrincipalConnection=Get-AutomationConnection -Name $connectionName         

        "Haciendo Log In en Azure"
        Add-AzureRmAccount `
            -ServicePrincipal `
            -TenantId $servicePrincipalConnection.TenantId `
            -ApplicationId $servicePrincipalConnection.ApplicationId `
            -CertificateThumbprint $servicePrincipalConnection.CertificateThumbprint 
    } catch 
    {
        if (!$servicePrincipalConnection)
        {
            $ErrorMessage = "Conexi√≥n $connectionName no existe."
            throw $ErrorMessage
        } else
        {
            Write-Error -Message $_.Exception
            throw $_.Exception
        }
    }
}
